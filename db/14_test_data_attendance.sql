-- SES Management System PostgreSQL Test Data
-- 14_test_data_attendance.sql: 勤怠と工数関連テストデータ
-- Created: 2025-05-06

-- 月次勤怠データ
INSERT INTO monthly_attendances (monthly_attendance_id, engineer_id, project_id, target_year, target_month, contracted_working_days, working_days, absence_days, paid_leave_days, total_working_hours, overtime_hours, night_work_hours, holiday_work_hours, status, remarks, submitted_at)
VALUES
    -- クラウド移行プロジェクトで働いている中村太郎の勤怠
    (1, 10, 6, 2025, 4, 20, 20, 0, 0, 160.0, 15.5, 2.0, 0.0, '確定', '4月の勤怠報告', '2025-05-01 10:00:00'),
    (2, 10, 6, 2025, 5, 19, 18, 0, 1.0, 144.0, 10.0, 1.5, 0.0, '承認済', '5月の勤怠報告', '2025-05-28 15:30:00'),
    
    -- クラウド移行プロジェクトで働いている田中三郎の勤怠
    (3, 3, 6, 2025, 4, 20, 19, 0, 1.0, 152.0, 8.0, 0.0, 0.0, '確定', '4月の勤怠報告', '2025-05-01 11:15:00'),
    (4, 3, 6, 2025, 5, 19, 19, 0, 0.0, 152.0, 12.5, 3.0, 0.0, '承認済', '5月の勤怠報告', '2025-05-29 10:45:00'),
    
    -- 次世代金融プラットフォーム構築で働いている高橋四郎の勤怠
    (5, 4, 2, 2025, 4, 20, 20, 0, 0.0, 160.0, 20.0, 5.0, 0.0, '確定', '4月の勤怠報告。プロジェクト立ち上げ時期のため残業あり。', '2025-05-02 09:30:00'),
    (6, 4, 2, 2025, 5, 19, 17, 0, 2.0, 136.0, 15.0, 3.0, 0.0, '承認済', '5月の勤怠報告。5/15-16有給取得。', '2025-05-27 16:40:00'),
    
    -- 医療予約システム開発で働いている山田花子の勤怠（まだ開発中）
    (7, 9, 3, 2025, 5, 19, 19, 0, 0.0, 152.0, 8.0, 0.0, 0.0, '作成中', '5月の勤怠入力中。', NULL);

-- 日次勤怠データ（クラウド移行プロジェクトで働いている中村太郎の5月分の一部）
INSERT INTO daily_attendances (daily_attendance_id, monthly_attendance_id, attendance_date, day_type, start_time, end_time, break_time, working_hours, overtime_hours, night_work_hours, attendance_type, location_type, location_details, remarks)
VALUES
    -- 5月第1週
    (1, 2, '2025-05-01', '平日', '09:00', '18:30', 1.0, 8.5, 0.5, 0.0, '出勤', '客先', 'ITコンサルティング本社', NULL),
    (2, 2, '2025-05-02', '平日', '09:00', '19:00', 1.0, 9.0, 1.0, 0.0, '出勤', '客先', 'ITコンサルティング本社', NULL),
    -- 5月第2週
    (3, 2, '2025-05-05', '祝日', NULL, NULL, 0.0, 0.0, 0.0, 0.0, '休日', '客先', NULL, '祝日（こどもの日）'),
    (4, 2, '2025-05-06', '平日', '09:00', '18:00', 1.0, 8.0, 0.0, 0.0, '出勤', '客先', 'ITコンサルティング本社', NULL),
    (5, 2, '2025-05-07', '平日', '09:00', '18:00', 1.0, 8.0, 0.0, 0.0, '出勤', '客先', 'ITコンサルティング本社', NULL),
    (6, 2, '2025-05-08', '平日', '09:00', '20:30', 1.0, 10.5, 2.5, 0.5, '出勤', '客先', 'ITコンサルティング本社', 'インフラ構築作業のため残業'),
    (7, 2, '2025-05-09', '平日', '09:00', '18:00', 1.0, 8.0, 0.0, 0.0, '出勤', '客先', 'ITコンサルティング本社', NULL),
    -- 5月第3週
    (8, 2, '2025-05-12', '平日', '09:00', '18:00', 1.0, 8.0, 0.0, 0.0, '出勤', '客先', 'ITコンサルティング本社', NULL),
    (9, 2, '2025-05-13', '平日', '09:00', '19:30', 1.0, 9.5, 1.5, 0.0, '出勤', '客先', 'ITコンサルティング本社', 'AWSへの移行計画策定作業'),
    (10, 2, '2025-05-14', '平日', '09:00', '18:00', 1.0, 8.0, 0.0, 0.0, '出勤', '客先', 'ITコンサルティング本社', NULL),
    (11, 2, '2025-05-15', '平日', '09:00', '18:00', 1.0, 8.0, 0.0, 0.0, '出勤', '客先', 'ITコンサルティング本社', NULL),
    (12, 2, '2025-05-16', '平日', '09:00', '18:00', 1.0, 8.0, 0.0, 0.0, '出勤', '客先', 'ITコンサルティング本社', NULL),
    -- 5月第4週
    (13, 2, '2025-05-19', '平日', '09:00', '18:00', 1.0, 8.0, 0.0, 0.0, '出勤', '客先', 'ITコンサルティング本社', NULL),
    (14, 2, '2025-05-20', '平日', '09:00', '18:00', 1.0, 8.0, 0.0, 0.0, '出勤', '客先', 'ITコンサルティング本社', NULL),
    (15, 2, '2025-05-21', '平日', '00:00', '00:00', 0.0, 0.0, 0.0, 0.0, '有給休暇', '客先', NULL, '有給取得'),
    (16, 2, '2025-05-22', '平日', '09:00', '20:00', 1.0, 10.0, 2.0, 0.0, '出勤', '客先', 'ITコンサルティング本社', '移行リハーサル実施のため残業'),
    (17, 2, '2025-05-23', '平日', '09:00', '21:00', 1.0, 11.0, 3.0, 1.0, '出勤', '客先', 'ITコンサルティング本社', '移行リハーサル後の問題対応のため残業');

-- 工数データ（クラウド移行プロジェクトで働いている中村太郎の5月分の一部）
INSERT INTO work_hours (daily_attendance_id, project_id, task_name, task_category, work_hours, billable, description)
VALUES
    -- 5月1日の工数
    (1, 6, 'プロジェクト計画修正', '会議', 2.0, TRUE, 'プロジェクト計画の見直しと修正'),
    (1, 6, 'AWS環境設計', '設計', 6.5, TRUE, 'AWSアーキテクチャ図の作成'),
    
    -- 5月2日の工数
    (2, 6, 'インフラチーム定例会議', '会議', 1.0, TRUE, '週次の進捗報告と課題共有'),
    (2, 6, 'セキュリティ設計レビュー', 'レビュー', 3.0, TRUE, 'セキュリティアーキテクチャのレビュー'),
    (2, 6, 'AWS環境設計', '設計', 5.0, TRUE, 'AWSアーキテクチャ図の修正と詳細化'),
    
    -- 5月6日の工数
    (4, 6, 'インフラ構築手順書作成', '設計', 5.0, TRUE, 'AWS環境構築の手順書作成'),
    (4, 6, 'CI/CD設計', '設計', 3.0, TRUE, 'CI/CDパイプラインの設計'),
    
    -- 5月7日の工数
    (5, 6, 'チーム会議', '会議', 1.0, TRUE, '日次のチーム会議'),
    (5, 6, 'CI/CD設計', '設計', 4.0, TRUE, 'CI/CDパイプラインの設計続き'),
    (5, 6, 'セキュリティ対策検討', '設計', 3.0, TRUE, 'WAFとセキュリティグループのルール検討'),
    
    -- 5月8日の工数
    (6, 6, 'AWS基盤構築', '開発', 8.0, TRUE, 'VPC、サブネット、セキュリティグループなど基本インフラの構築'),
    (6, 6, '構築作業追加対応', '開発', 2.5, TRUE, 'AWS基盤構築の追加作業と動作確認'),
    
    -- 5月9日の工数
    (7, 6, 'チーム会議', '会議', 1.0, TRUE, '日次のチーム会議'),
    (7, 6, 'AWS基盤構築', '開発', 5.0, TRUE, 'EC2、RDS、S3などのサービス設定'),
    (7, 6, '週次進捗報告作成', 'その他', 2.0, TRUE, '週次進捗報告資料の作成'),
    
    -- 5月12日の工数
    (8, 6, 'プロジェクト全体会議', '会議', 2.0, TRUE, '隔週のプロジェクト全体会議'),
    (8, 6, 'AWS基盤構築', '開発', 4.0, TRUE, 'ELB、CloudFrontなど追加サービスの設定'),
    (8, 6, 'CI/CD環境構築', '開発', 2.0, TRUE, 'CodePipelineの設定開始'),
    
    -- 5月13日の工数
    (9, 6, 'チーム会議', '会議', 1.0, TRUE, '日次のチーム会議'),
    (9, 6, 'CI/CD環境構築', '開発', 6.0, TRUE, 'CodeBuild、CodeDeployの設定'),
    (9, 6, '移行計画書作成', '設計', 2.5, TRUE, '本番環境移行計画書の作成開始'),
    
    -- 5月14日の工数
    (10, 6, 'チーム会議', '会議', 1.0, TRUE, '日次のチーム会議'),
    (10, 6, '移行計画書作成', '設計', 5.0, TRUE, '本番環境移行計画書の作成続き'),
    (10, 6, 'セキュリティ設定確認', 'テスト', 2.0, TRUE, 'セキュリティグループとIAM権限の確認'),
    
    -- 5月15日の工数
    (11, 6, 'インフラチーム定例会議', '会議', 1.0, TRUE, '週次の進捗報告と課題共有'),
    (11, 6, '移行計画書レビュー', 'レビュー', 3.0, TRUE, '移行計画書のレビュー会議'),
    (11, 6, '移行計画書修正', '設計', 4.0, TRUE, 'レビュー結果に基づく移行計画書の修正'),
    
    -- 5月16日の工数
    (12, 6, 'チーム会議', '会議', 1.0, TRUE, '日次のチーム会議'),
    (12, 6, '移行リハーサル準備', '設計', 5.0, TRUE, '移行リハーサルの手順確認と準備'),
    (12, 6, '週次進捗報告作成', 'その他', 2.0, TRUE, '週次進捗報告資料の作成'),
    
    -- 5月19日の工数
    (13, 6, 'プロジェクト全体会議', '会議', 2.0, TRUE, '隔週のプロジェクト全体会議'),
    (13, 6, '移行リハーサル準備', '設計', 4.0, TRUE, '移行リハーサルの環境準備'),
    (13, 6, 'モニタリング設定', '開発', 2.0, TRUE, 'CloudWatchによるモニタリング設定'),
    
    -- 5月20日の工数
    (14, 6, 'チーム会議', '会議', 1.0, TRUE, '日次のチーム会議'),
    (14, 6, '移行リハーサル準備', '設計', 6.0, TRUE, '移行リハーサルの手順の最終確認'),
    (14, 6, 'アラート設定', '開発', 1.0, TRUE, 'CloudWatchアラートの設定'),
    
    -- 5月22日の工数（移行リハーサル実施日）
    (16, 6, '移行リハーサル実施', 'テスト', 8.0, TRUE, '移行リハーサルの実施と進行管理'),
    (16, 6, 'リハーサル結果確認', 'テスト', 2.0, TRUE, 'リハーサル結果の検証と問題点の洗い出し'),
    
    -- 5月23日の工数（移行リハーサル後の問題対応）
    (17, 6, '問題対応ミーティング', '会議', 2.0, TRUE, 'リハーサルで発見された問題の対応検討会議'),
    (17, 6, 'リハーサル問題対応', '開発', 7.0, TRUE, 'リハーサルで発見された問題の修正作業'),
    (17, 6, '移行計画書更新', '設計', 2.0, TRUE, 'リハーサル結果に基づく移行計画書の更新');

-- 承認フローデータ
INSERT INTO approval_flows (flow_id, monthly_attendance_id, current_step, flow_type, status)
VALUES
    (1, 1, 3, '標準', '完了'),     -- 中村太郎の4月分（確定済み）
    (2, 2, 2, '標準', '承認中'),  -- 中村太郎の5月分（承認済み）
    (3, 3, 3, '標準', '完了'),     -- 田中三郎の4月分（確定済み）
    (4, 4, 2, '標準', '承認中'),  -- 田中三郎の5月分（承認済み）
    (5, 5, 3, '標準', '完了'),     -- 高橋四郎の4月分（確定済み）
    (6, 6, 2, '標準', '承認中');  -- 高橋四郎の5月分（承認済み）

-- 承認ステップデータ
INSERT INTO approval_steps (flow_id, step_number, approver_id, approver_role, status, approved_at, comments)
VALUES
    -- 中村太郎の4月分（確定済み）の承認ステップ
    (1, 1, 'b2b2b2b2-b2b2-b2b2-b2b2-b2b2b2b2b2b2', 'PM', '承認', '2025-05-02 10:30:00', '問題ありません。承認します。'),
    (1, 2, 'd4d4d4d4-d4d4-d4d4-d4d4-d4d4d4d4d4d4', '管理者', '承認', '2025-05-03 14:15:00', '勤怠内容を確認しました。承認します。'),
    (1, 3, 'f6f6f6f6-f6f6-f6f6-f6f6-f6f6f6f6f6f6', '経理', '承認', '2025-05-04 11:20:00', '経理確認完了。承認します。'),
    
    -- 中村太郎の5月分（承認済み）の承認ステップ
    (2, 1, 'b2b2b2b2-b2b2-b2b2-b2b2-b2b2b2b2b2b2', 'PM', '承認', '2025-05-29 09:45:00', '内容確認しました。問題ありません。'),
    (2, 2, 'd4d4d4d4-d4d4-d4d4-d4d4-d4d4d4d4d4d4', '管理者', '承認', '2025-05-30 13:20:00', '勤怠内容を確認しました。承認します。'),
    (2, 3, 'f6f6f6f6-f6f6-f6f6-f6f6-f6f6f6f6f6f6', '経理', '未対応', NULL, NULL),
    
    -- 田中三郎の4月分（確定済み）の承認ステップ
    (3, 1, 'b2b2b2b2-b2b2-b2b2-b2b2-b2b2b2b2b2b2', 'PM', '承認', '2025-05-02 11:00:00', '問題ありません。承認します。'),
    (3, 2, 'd4d4d4d4-d4d4-d4d4-d4d4-d4d4d4d4d4d4', '管理者', '承認', '2025-05-03 15:30:00', '勤怠内容を確認しました。承認します。'),
    (3, 3, 'f6f6f6f6-f6f6-f6f6-f6f6-f6f6f6f6f6f6', '経理', '承認', '2025-05-04 12:45:00', '経理確認完了。承認します。'),
    
    -- 田中三郎の5月分（承認済み）の承認ステップ
    (4, 1, 'b2b2b2b2-b2b2-b2b2-b2b2-b2b2b2b2b2b2', 'PM', '承認', '2025-05-30 10:15:00', '内容確認しました。問題ありません。'),
    (4, 2, 'd4d4d4d4-d4d4-d4d4-d4d4-d4d4d4d4d4d4', '管理者', '承認', '2025-05-31 09:45:00', '勤怠内容を確認しました。承認します。'),
    (4, 3, 'f6f6f6f6-f6f6-f6f6-f6f6-f6f6f6f6f6f6', '経理', '未対応', NULL, NULL),
    
    -- 高橋四郎の4月分（確定済み）の承認ステップ
    (5, 1, 'b2b2b2b2-b2b2-b2b2-b2b2-b2b2b2b2b2b2', 'PM', '承認', '2025-05-03 09:30:00', '残業が多いですが、プロジェクト立ち上げ時期のため承認します。'),
    (5, 2, 'd4d4d4d4-d4d4-d4d4-d4d4-d4d4d4d4d4d4', '管理者', '承認', '2025-05-04 10:45:00', '勤怠内容を確認しました。承認します。'),
    (5, 3, 'f6f6f6f6-f6f6-f6f6-f6f6-f6f6f6f6f6f6', '経理', '承認', '2025-05-05 14:20:00', '経理確認完了。承認します。'),
    
    -- 高橋四郎の5月分（承認済み）の承認ステップ
    (6, 1, 'b2b2b2b2-b2b2-b2b2-b2b2-b2b2b2b2b2b2', 'PM', '承認', '2025-05-28 16:00:00', '内容確認しました。問題ありません。'),
    (6, 2, 'd4d4d4d4-d4d4-d4d4-d4d4-d4d4d4d4d4d4', '管理者', '承認', '2025-05-29 11:30:00', '勤怠内容を確認しました。承認します。'),
    (6, 3, 'f6f6f6f6-f6f6-f6f6-f6f6-f6f6f6f6f6f6', '経理', '未対応', NULL, NULL);

-- 勤怠通知データ
INSERT INTO attendance_notifications (notification_id, notification_type, user_id, title, message, related_entity, entity_id, is_read, read_at, notify_at)
VALUES
    -- 中村太郎への通知
    (1, '勤怠承認完了', 'c3c3c3c3-c3c3-c3c3-c3c3-c3c3c3c3c3c3', '4月分勤怠が確定されました', '4月分の勤怠が最終承認され、確定されました。', 'monthly_attendance', 1, TRUE, '2025-05-05 09:15:00', '2025-05-05 09:00:00'),
    (2, '勤怠承認依頼', 'b2b2b2b2-b2b2-b2b2-b2b2-b2b2b2b2b2b2', '勤怠承認依頼：中村太郎（5月分）', '中村太郎さんの5月分勤怠の承認依頼が届いています。', 'monthly_attendance', 2, TRUE, '2025-05-28 16:00:00', '2025-05-28 15:40:00'),
    (3, '勤怠提出リマインド', 'a1a1a1a1-a1a1-a1a1-a1a1-a1a1a1a1a1a1', '5月分勤怠提出のリマインド（最終日）', '5月分の勤怠入力と提出は5月31日が締め切りです。まだ提出していないエンジニアに連絡してください。', 'other', NULL, TRUE, '2025-05-31 08:30:00', '2025-05-31 08:00:00'),
    
    -- 田中三郎への通知
    (4, '勤怠承認完了', 'c3c3c3c3-c3c3-c3c3-c3c3-c3c3c3c3c3c3', '4月分勤怠が確定されました', '4月分の勤怠が最終承認され、確定されました。', 'monthly_attendance', 3, TRUE, '2025-05-05 10:30:00', '2025-05-05 10:00:00'),
    (5, '勤怠承認依頼', 'b2b2b2b2-b2b2-b2b2-b2b2-b2b2b2b2b2b2', '勤怠承認依頼：田中三郎（5月分）', '田中三郎さんの5月分勤怠の承認依頼が届いています。', 'monthly_attendance', 4, TRUE, '2025-05-30 11:00:00', '2025-05-30 10:45:00'),
    
    -- 高橋四郎への通知
    (6, '勤怠承認完了', 'c3c3c3c3-c3c3-c3c3-c3c3-c3c3c3c3c3c3', '4月分勤怠が確定されました', '4月分の勤怠が最終承認され、確定されました。', 'monthly_attendance', 5, TRUE, '2025-05-06 09:45:00', '2025-05-06 09:00:00'),
    (7, '勤怠承認依頼', 'b2b2b2b2-b2b2-b2b2-b2b2-b2b2b2b2b2b2', '勤怠承認依頼：高橋四郎（5月分）', '高橋四郎さんの5月分勤怠の承認依頼が届いています。', 'monthly_attendance', 6, TRUE, '2025-05-27 17:00:00', '2025-05-27 16:45:00'),
    
    -- 山田花子への通知
    (8, '勤怠提出リマインド', 'a7a7a7a7-a7a7-a7a7-a7a7-a7a7a7a7a7a7', '5月分勤怠提出のリマインド', '5月分の勤怠入力と提出は5月31日が締め切りです。まだ完了していない場合は早めに入力してください。', 'monthly_attendance', 7, FALSE, NULL, '2025-05-29 09:00:00');