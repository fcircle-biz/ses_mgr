# モジュール詳細設計ドキュメント分割方針

## 1. 目的

本方針は、SES業務システムの詳細設計ドキュメントにおけるモジュール設計の細分化について定義します。これにより、以下のメリットを実現します：

- ドキュメントの肥大化防止
- メンテナンス性の向上
- 並行作業の効率化
- レビュー・更新の容易性確保
- 変更影響範囲の最小化

## 2. ドキュメント分割ガイドライン

### 2.1 基本的な分割単位

各業務モジュールの詳細設計ドキュメントは、以下の観点で分割します：

1. **機能別分割**：モジュール内の主要な機能単位ごとに分割
2. **レイヤー別分割**：必要に応じて、ドメインモデル、サービス、インターフェース等を分離
3. **サイズ制限**：一つのマークダウンファイルは1000行程度を目安に制限

### 2.2 標準的なファイル構成

各モジュールのドキュメントは、以下の標準ファイル構成に従います：

- `README.md`：モジュール概要と索引
- `01_概要.md`：モジュールの目的、主要機能、ユースケース、アーキテクチャ
- `02_ドメインモデル.md`：エンティティ定義、値オブジェクト、列挙型、ドメイン関連図
- `03_{機能A}.md`：個別機能の詳細設計（例：案件基本機能、案件検索機能）
- `04_{機能B}.md`：個別機能の詳細設計
- ...
- `NN_DB設計.md`：データベース設計、テーブル定義
- `NN_API設計.md`：API仕様、エンドポイント定義
- `NN_テスト計画.md`：テスト方針、テストケース、テスト自動化

### 2.3 機能分割の基準

機能を分割する際の目安：

1. **業務フロー単位**：一連の業務フローごとに分割（例：契約作成フロー、契約承認フロー）
2. **CRUD単位**：基本的なCRUD操作をひとまとまりとして分割
3. **複雑さ**：特に複雑なロジックを含む機能は独立したファイルに分割
4. **変更頻度**：変更頻度の高い部分と低い部分を分離
5. **サイズ**：ファイルサイズが大きくなりそうな機能は細分化

## 3. 具体的な分割例

### 3.1 案件管理モジュール

- `README.md`：案件管理モジュール概要と索引
- `01_概要.md`：案件管理の目的、主要機能、アーキテクチャ
- `02_ドメインモデル.md`：案件エンティティ、ステータス管理、値オブジェクト定義
- `03_案件基本機能.md`：案件の登録・更新・削除機能
- `04_案件検索機能.md`：案件検索、フィルタリング機能
- `05_案件ステータス管理.md`：ステータス遷移、ライフサイクル管理
- `06_DB設計.md`：データベース設計
- `07_API設計.md`：API仕様
- `08_テスト計画.md`：テスト方針、テストケース

### 3.2 マッチング機能モジュール

- `README.md`：マッチング機能モジュール概要と索引
- `01_概要.md`：マッチングの目的、主要機能、アーキテクチャ
- `02_ドメインモデル.md`：マッチング結果エンティティ、スコア計算モデル
- `03_マッチングエンジン.md`：マッチングアルゴリズム、スコアリングロジック
- `04_候補者検索機能.md`：技術者・案件の検索、フィルタリング機能
- `05_提案管理機能.md`：提案作成、提案ワークフロー管理
- `06_DB設計.md`：データベース設計
- `07_API設計.md`：API仕様
- `08_テスト計画.md`：テスト方針、テストケース

### 3.3 契約管理モジュール

- `README.md`：契約管理モジュール概要と索引
- `01_概要.md`：契約管理の目的、主要機能、アーキテクチャ
- `02_ドメインモデル.md`：契約エンティティ、テンプレート、署名リクエスト
- `03_契約基本機能.md`：契約の登録・更新・削除機能
- `04_テンプレート管理.md`：契約テンプレート管理機能
- `05_契約書生成.md`：契約書生成、PDF作成機能
- `06_電子署名機能.md`：署名ワークフロー、署名検証
- `07_契約ライフサイクル.md`：契約更新、終了管理
- `08_DB設計.md`：データベース設計
- `09_API設計.md`：API仕様
- `10_テスト計画.md`：テスト方針、テストケース

## 4. インデックスファイル（README.md）の構成

各モジュールのルートディレクトリには、モジュール内のドキュメントを一覧するREADME.mdを配置します。
構成例：

```markdown
# {モジュール名} 詳細設計

## 概要
{モジュールの簡単な説明}

## ドキュメント構成

| ドキュメント | 内容 | 最終更新日 |
|------------|------|----------|
| [01_概要](./01_概要.md) | モジュールの目的、主要機能、アーキテクチャ | 2025-05-XX |
| [02_ドメインモデル](./02_ドメインモデル.md) | エンティティ定義、値オブジェクト | 2025-05-XX |
| [03_機能A](./03_機能A.md) | 機能Aの詳細設計 | 2025-05-XX |
| ... | ... | ... |

## 関連モジュール

- [モジュールA](../モジュールA/)
- [モジュールB](../モジュールB/)

## 変更履歴

| 日付 | 変更者 | 内容 |
|------|-------|------|
| 2025-05-XX | XX | 初版作成 |
```

## 5. ドキュメント間の参照ルール

1. **相対パスの使用**：モジュール内の他ドキュメントを参照する際は相対パスを使用
2. **アンカーリンク**：同一ドキュメント内の参照はアンカーリンク（`#セクション名`）を使用
3. **セクション参照**：他ドキュメントの特定セクションを参照する場合は `ファイル名.md#セクション名` の形式を使用
4. **重複の回避**：詳細情報は1箇所にのみ記述し、他の場所からは参照する形式を採用

## 6. メンテナンスポリシー

1. **更新履歴**：各ファイルの冒頭にバージョン管理テーブルを配置し、変更履歴を記録
2. **一貫性維持**：モジュール間で影響のある変更は、関連するすべてのドキュメントを同時に更新
3. **最新性確認**：四半期ごとに全ドキュメントの内容を確認し、最新状態を維持
4. **レビュー方針**：ドキュメント更新時は、最低1名によるレビューを実施

## 7. 移行計画

既存の大規模なモジュール設計ドキュメントは、以下の手順で分割を進めます：

1. インデックスファイル（README.md）の作成
2. ドメインモデル、概要部分の抽出
3. 機能単位での分割
4. 相互参照リンクの整備
5. 元のファイルの廃止

各モジュールの分割は2025年5月末までに完了させる計画です。