# コードレビューガイドライン

このガイドラインは、SES管理システムの開発におけるコードレビューの標準とベストプラクティスを定義します。コードレビューは品質確保の重要なプロセスであり、一貫したレビュー基準を設けることで、効率的かつ効果的なレビューを実現します。

## 目次

1. [コードレビューの目的](#1-コードレビューの目的)
2. [レビュープロセス](#2-レビュープロセス)
3. [レビュー基準](#3-レビュー基準)
4. [フィードバックの提供方法](#4-フィードバックの提供方法)
5. [コードレビューチェックリスト](#5-コードレビューチェックリスト)

## 1. コードレビューの目的

コードレビューの主な目的は以下の通りです：

1. **品質の確保**: バグや設計上の問題を早期に発見し修正する
2. **知識の共有**: コードベースに対する理解を開発者間で共有する
3. **一貫性の維持**: コーディング規約やアーキテクチャガイドラインへの準拠を確認する
4. **セキュリティの向上**: セキュリティ上の脆弱性を発見し排除する
5. **チーム成長**: メンバー間のフィードバックを通じて技術力を向上させる

## 2. レビュープロセス

### 2.1 プルリクエスト作成前

1. 自己レビューを実施
2. 静的解析ツールによるチェック
3. テストの実行と合格確認
4. コーディング規約への準拠確認

### 2.2 プルリクエストの作成

1. 変更内容を明確に説明
2. 関連する課題/要件へのリンク
3. レビュアーのアサイン（最低1名以上）
4. 必要に応じて特定の確認ポイントを明記

### 2.3 レビュー実施

1. レビュアーは24時間以内（営業日）にレビューを開始
2. チェックリストに基づいたレビュー
3. 建設的なフィードバックの提供
4. コード上の問題点だけでなく、良い点も指摘

### 2.4 フィードバック対応

1. すべてのフィードバックに対応
2. 議論が必要な点は対面やオンライン会議で解決
3. 対応完了後、レビュアーに再レビューを依頼

### 2.5 マージ条件

1. 少なくとも1名のレビュアーの承認
2. すべてのテストがパス
3. すべての必須レビューコメントが解決
4. CIパイプラインの成功

## 3. レビュー基準

### 3.1 機能面

- 要件を満たしているか
- エッジケースが考慮されているか
- ユーザビリティが確保されているか
- 既存機能に悪影響がないか

### 3.2 コード品質

- コーディング規約に準拠しているか
- 命名が明確で一貫しているか
- コードの重複がないか
- 責務の分離が適切か

### 3.3 アーキテクチャ

- レイヤードアーキテクチャに沿っているか
- 適切なデザインパターンが使用されているか
- 依存関係が明確で適切か
- 拡張性が考慮されているか

### 3.4 パフォーマンス

- N+1問題が発生していないか
- 不必要なデータベースアクセスがないか
- リソースの使用が効率的か
- 大量データ処理が最適化されているか

### 3.5 セキュリティ

- 入力バリデーションが適切か
- 認証・認可が正しく実装されているか
- SQLインジェクション対策がとられているか
- 機密情報の取り扱いが適切か

### 3.6 テスト

- 適切なテストが書かれているか
- テストケースが十分かつ意味のあるものか
- エッジケースがテストされているか
- テストの独立性が保たれているか

## 4. フィードバックの提供方法

### 4.1 効果的なフィードバック

- 明確かつ具体的に問題点を指摘
- 理由や根拠を示す
- 可能な場合は改善案を提示
- 個人ではなくコードに焦点を当てる

### 4.2 フィードバックの分類

- **必須（Blocker）**: マージ前に修正必須の問題
- **推奨（Important）**: 修正が強く推奨される問題
- **提案（Nice to have）**: 改善の提案
- **質問（Question）**: 理解のための質問
- **賞賛（Praise）**: 良い実装への評価

### 4.3 コミュニケーションのガイドライン

- 敬意を持ったコミュニケーション
- 建設的なフィードバック
- 質問形式での提案
- 知識共有の機会として活用

## 5. コードレビューチェックリスト

以下のチェックリストを使用して、レビューの漏れを防ぎます。

### 5.1 一般

- [ ] コードはコーディング規約に従っているか
- [ ] コードの意図が明確に理解できるか
- [ ] 命名が適切で理解しやすいか
- [ ] 不必要なコメントやコードが含まれていないか
- [ ] メソッドや関数の長さは適切か
- [ ] コードの重複がないか

### 5.2 機能

- [ ] すべての要件が実装されているか
- [ ] エッジケースが適切に処理されているか
- [ ] エラー処理が適切に実装されているか
- [ ] ユーザーエクスペリエンスが考慮されているか
- [ ] 国際化対応が必要な場合、適切に実装されているか
- [ ] 既存機能との整合性が取れているか

### 5.3 アーキテクチャ

- [ ] レイヤー間の責務分離が適切か
- [ ] 適切なデザインパターンが使用されているか
- [ ] 依存関係が明確で適切か
- [ ] DRY原則が守られているか
- [ ] SOLIDの原則に従っているか
- [ ] 技術的負債を増やしていないか

### 5.4 パフォーマンス

- [ ] N+1問題を発生させていないか
- [ ] 適切なインデックスが使用されているか
- [ ] 不必要なデータベースアクセスがないか
- [ ] クエリの最適化が行われているか
- [ ] 大量データ処理時のパフォーマンスが考慮されているか
- [ ] リソースはタイムリーに解放されているか

### 5.5 セキュリティ

- [ ] 入力値の検証が適切に行われているか
- [ ] SQLインジェクション対策がとられているか
- [ ] XSS対策がとられているか
- [ ] CSRF対策がとられているか
- [ ] 認証・認可が適切に実装されているか
- [ ] 機密情報が適切に保護されているか
- [ ] エラーメッセージが機密情報を漏洩していないか

### 5.6 テスト

- [ ] 単体テストが実装されているか
- [ ] テストカバレッジが十分か
- [ ] テストケースが意味のあるものか
- [ ] 境界値や例外ケースのテストが含まれているか
- [ ] テストが独立して実行可能か
- [ ] テストが高速に実行可能か

### 5.7 ドキュメンテーション

- [ ] JavaDocやコメントが適切に記述されているか
- [ ] 複雑なロジックには説明が追加されているか
- [ ] PublicインターフェイスにはJavaDocが記述されているか
- [ ] APIドキュメントが更新されているか
- [ ] 必要に応じてREADMEなどが更新されているか

このガイドラインとチェックリストを活用し、効果的なコードレビューを実施することで、SES管理システムの品質を継続的に向上させることができます。