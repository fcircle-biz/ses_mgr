# SES業務システム 基本設計ドキュメント作成手順

## 1. 概要

本文書は、SES業務システムの基本設計フェーズで作成すべきドキュメントとその作成手順について記載しています。基本設計フェーズでは、要件定義をもとに、システムの全体構成、機能仕様、画面、データベース、外部インターフェースなどの設計を行います。

## 2. 基本設計フェーズの目的

- 要件定義で決定した機能要件・非機能要件を技術的に実現するための設計を行う
- システム開発の基盤となる「設計書」を作成する
- 詳細設計・開発フェーズでのリスクを低減するための設計判断を行う
- 設計上の課題や制約を明確にし、対策を示す

## 3. 基本設計ドキュメント構成

基本設計フェーズでは、以下のドキュメントを作成します：

### 3.1 システム設計書

- **ファイル形式**: HTML
- **命名規則**: `システム設計書_SES業務システム.html`
- **保存場所**: `/docs/基本設計/システム設計/`
- **内容**:
  - システム全体構成図
  - マイクロサービス構成
  - サブシステム構成
  - デプロイメント図
  - ネットワーク構成図
  - サーバー構成（仮想/物理）
  - セキュリティ設計
  - 性能設計
  - 可用性設計（冗長構成など）
  - バックアップ設計
  - バッチ処理一覧
  - 権限設計
  - エラー処理設計
  - ログ設計

### 3.2 UI設計書

- **ファイル形式**: HTML + Figma設計ファイル
- **命名規則**: `UI設計書_SES業務システム.html`
- **保存場所**: `/docs/基本設計/UI設計/`
- **内容**:
  - 画面構成図（画面遷移図）
  - 画面一覧
  - 各画面のワイヤーフレーム/モックアップ
  - 画面項目定義
  - 入力チェック仕様
  - ボタンアクション定義
  - レスポンシブ対応指針
  - 共通部品定義

### 3.3 DB設計書

- **ファイル形式**: HTML + ER図（drawio）
- **命名規則**: `DB設計書_SES業務システム.html`
- **保存場所**: `/docs/基本設計/DB設計/`
- **内容**:
  - ER図（論理/物理）
  - テーブル一覧
  - テーブル定義
  - カラム定義（型、制約、デフォルト値など）
  - インデックス設計
  - リレーション設計
  - トランザクション設計
  - パーティション設計
  - マスタデータ設計

### 3.4 インターフェース設計書

- **ファイル形式**: HTML + Swagger/OpenAPI仕様書
- **命名規則**: `インターフェース設計書_SES業務システム.html`
- **保存場所**: `/docs/基本設計/IF設計/`
- **内容**:
  - 外部連携システム一覧
  - API一覧
  - API仕様（エンドポイント、パラメータ、レスポンスなど）
  - 認証・認可方式
  - データフォーマット定義
  - エラーハンドリング
  - タイムアウト設定
  - 通信プロトコル設定

### 3.5 共通機能設計書

- **ファイル形式**: HTML
- **命名規則**: `共通機能設計書_SES業務システム.html`
- **保存場所**: `/docs/基本設計/共通機能/`
- **内容**:
  - 認証・認可機能
  - ログ管理機能
  - エラー処理共通機能
  - バッチ処理フレームワーク
  - トランザクション管理
  - キャッシュ機能
  - 通知機能
  - ファイル管理機能

## 4. 作成手順

基本設計ドキュメントの作成手順は以下の通りです：

### 4.1 準備作業

1. Git リポジトリから最新の情報を取得
   ```bash
   git pull origin main
   ```

2. 基本設計フォルダ構成を作成
   ```bash
   mkdir -p docs/基本設計/{システム設計,UI設計,DB設計,IF設計,共通機能}
   ```

3. テンプレートをコピー（プロジェクトテンプレートリポジトリから取得）
   ```bash
   # 例：テンプレートが別リポジトリにある場合
   git clone https://github.com/example/templates.git temp_templates
   cp -r temp_templates/basic_design/* docs/基本設計/
   rm -rf temp_templates
   ```

### 4.2 設計作業の実施順序

1. **システム設計**（1週目）
   - 全体アーキテクチャの検討
   - マイクロサービス分割の検討
   - デプロイメントモデルの検討
   - 技術選定の詳細化

2. **DB設計**（2週目）
   - ER図の詳細化（既存ER図をベースに）
   - テーブル定義の作成
   - インデックス検討
   - マスタデータ設計

3. **UI設計**（3週目）
   - 画面遷移図の作成
   - 主要画面のワイヤーフレーム作成
   - 詳細画面設計
   - Figmaでのモックアップ作成

4. **インターフェース設計**（4週目）
   - API設計（Swagger/OpenAPI形式）
   - 外部連携方式の詳細化
   - データフォーマット定義

5. **共通機能設計**（5週目）
   - 認証・認可設計
   - 共通部品設計
   - エラー処理設計

### 4.3 レビュー手順

1. 各設計書作成後、担当者による内部レビュー
2. チームレビュー（週次）
3. ステークホルダーレビュー（隔週）
4. レビュー指摘事項の修正
5. 承認プロセス

### 4.4 バージョン管理

- 設計書はGitでバージョン管理
- 変更履歴を各ドキュメントの先頭に記載
- コミットメッセージには変更内容を明記
  ```bash
  git add docs/基本設計/システム設計/システム設計書_SES業務システム.html
  git commit -m "システム設計書：デプロイメント構成を更新"
  git push origin feature/basic-design
  ```

## 5. 基本設計のポイント

### 5.1 技術スタックに関する考慮点

- **Java Spring Boot**
  - バージョン選定（最新の安定版を推奨）
  - Spring Boot Starter の選定
  - Spring Security の設定
  - JPA/Hibernate の設定

- **Thymeleaf**
  - レイアウトテンプレート設計
  - フラグメント設計
  - JavaScriptとの連携方針

- **PostgreSQL**
  - バージョン選定
  - テーブル設計の最適化
  - インデックス戦略
  - 性能を考慮したSQL設計

- **Docker**
  - コンテナ設計
  - Docker Compose 設定
  - 環境変数管理
  - ボリューム設計

### 5.2 マイクロサービス設計のポイント

- サービス分割の粒度
- サービス間通信方式
- データ整合性の確保
- 障害対策（Circuit Breaker パターンなど）

### 5.3 セキュリティ設計のポイント

- OWASP Top 10 への対応
- OAuth2/OpenID Connect の実装
- 二要素認証の実装
- セキュアコーディングガイドライン

## 6. 成果物チェックリスト

基本設計フェーズ完了時に以下の成果物が揃っていることを確認：

- [ ] システム設計書
- [ ] UI設計書（画面ワイヤーフレーム/モックアップ含む）
- [ ] DB設計書（ER図含む）
- [ ] インターフェース設計書（API仕様含む）
- [ ] 共通機能設計書
- [ ] レビュー議事録
- [ ] 指摘事項対応表

## 7. 注意事項

- 要件定義書との整合性を常に確認すること
- 技術的な制約や課題が発見された場合は、対応方針を明確にし、必要に応じて要件との調整を行うこと
- 詳細設計・開発工程を意識し、実装可能な設計とすること
- 技術負債となる設計は避け、保守性・拡張性を重視すること
- セキュリティ要件を満たす設計を徹底すること

### 7.1 ドキュメントの細分化ガイドライン

基本設計ドキュメントは適切に細分化し、管理しやすくすることが重要です：

- **機能別の分割**：
  - 各業務領域（案件管理、技術者管理など）ごとに設計ドキュメントを分割
  - 各業務領域内でさらに、UI設計、DB設計、API設計などを分割
  - REST API設計はさらにサブ機能ごとに細分化（例：技術者管理API → 技術者基本API、スキル管理APIなど）

- **ドキュメントサイズの制限**：
  - 1つのドキュメントファイルは2000行以内を目安にする
  - ER図は機能領域ごとに分割し、全体を俯瞰する概念ERと詳細ERに分ける
  - API仕様書は、概要ドキュメントと詳細仕様ドキュメントに分ける

- **標準化と参照の仕組み**：
  - インデックスファイルを作成し、関連ドキュメント間をリンクで繋ぐ
  - 共通部分は別ファイルにし、参照する形にする
  - 命名規則を統一し、ファイル名からコンテンツを推測できるようにする

このような細分化により、チームメンバーによる並行作業が容易になり、レビュー効率が向上し、変更影響範囲が限定されます。また、ドキュメントの読み込み・編集時のパフォーマンスも向上します。