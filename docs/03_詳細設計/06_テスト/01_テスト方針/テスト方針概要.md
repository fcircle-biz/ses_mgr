# SES業務システム テスト方針概要

## 1. はじめに

### 1.1 目的

本ドキュメントは、SES業務システムのテスト全体の方針と戦略を定義するものである。品質確保のためのテスト実施方法、テスト種別、テストの責任範囲、ツール、環境などについて包括的なガイドラインを提供する。

### 1.2 適用範囲

本テスト方針は、SES業務システムの以下のテスト活動に適用される：

- 単体テスト
- 統合テスト
- エンドツーエンド(E2E)テスト
- セキュリティテスト
- 性能テスト
- ユーザー受入テスト

### 1.3 参照ドキュメント

- [要件定義書](/docs/01_要件定義/要件定義書.html)
- [基本設計書：システム設計](/docs/02_基本設計/システム設計/index.html)
- [詳細設計：アーキテクチャ概要](/docs/03_詳細設計/01_アーキテクチャ/アーキテクチャ概要.md)
- [詳細設計：セキュリティ設計概要](/docs/03_詳細設計/05_セキュリティ/01_セキュリティ設計概要.md)

## 2. テスト戦略

### 2.1 テスト全体方針

SES業務システムのテストでは、以下の原則に基づきテスト活動を実施する：

1. **シフトレフト**: テストを開発プロセスの早い段階から統合し、問題の早期発見と対処を行う
2. **自動化優先**: 可能な限りテストを自動化し、継続的インテグレーション/継続的デリバリー(CI/CD)パイプラインに組み込む
3. **リスクベース**: 重要度・複雑度・変更頻度等のリスクに応じてテスト優先度を決定する
4. **段階的アプローチ**: 単体テスト→統合テスト→E2Eテストの順に段階的に検証を行う
5. **品質ゲート**: 各テストレベルで明確な品質基準（カバレッジ、バグ密度等）を設け、次工程への条件とする

### 2.2 テスト種別と目的

| テスト種別 | 目的 | 実施タイミング | 自動化レベル |
|-----------|------|--------------|------------|
| 単体テスト | 個々のコンポーネント（クラス、メソッド）の機能検証 | 実装と同時 | 100% 自動化 |
| 統合テスト | コンポーネント間の連携や外部システム連携の検証 | 機能実装完了時 | 90% 自動化 |
| E2Eテスト | ユーザーシナリオに基づく一連の処理フローの検証 | 大きな機能セット完了時 | 80% 自動化 |
| セキュリティテスト | セキュリティ要件の検証と脆弱性の検出 | 定期的・リリース前 | 75% 自動化 |
| 性能テスト | 応答性能、スケーラビリティ、安定性の検証 | 主要機能セット完了時、リリース前 | 90% 自動化 |
| ユーザー受入テスト | 業務要件の充足確認と最終承認 | リリース前 | 50% 自動化 |

### 2.3 テスト環境

テストを効率的に実施するため、以下の独立した環境を整備する：

| 環境名 | 用途 | 構成 | アクセス制限 |
|-------|------|-----|------------|
| 開発環境 | 開発者による単体テスト・統合テスト | 開発スペックの縮小構成、ダミーデータ | 開発者のみ |
| テスト環境 | QAチームによる体系的テスト | 本番相当の縮小構成、テストデータ | 開発者、QA、PMのみ |
| ステージング環境 | リリース前の最終検証 | 本番と同等構成、マスクした本番データ | 開発者、QA、PM、承認された業務担当者 |
| 性能テスト環境 | 負荷テスト・性能検証 | 本番と同等規模、ダミーデータ大量生成 | 性能テスト担当者のみ |

### 2.4 テスト責任範囲

| ロール | 責任範囲 |
|-------|---------|
| 開発者 | ・単体テストの作成と実行<br>・統合テストの作成と実行<br>・CIでのテスト結果確認と修正 |
| QAエンジニア | ・テスト計画の策定<br>・E2Eテストの作成と実行<br>・バグの報告と追跡<br>・テスト結果の分析とレポート |
| セキュリティ専門家 | ・セキュリティテスト計画の策定<br>・脆弱性スキャンの実行と評価<br>・セキュリティテスト結果の分析とレポート |
| パフォーマンスエンジニア | ・性能テスト計画の策定<br>・負荷テストの作成と実行<br>・性能測定とボトルネック分析 |
| プロジェクトマネージャ | ・テスト全体の監督<br>・リスク管理とリソース確保<br>・経営陣・ステークホルダーへの報告 |
| 業務担当者 | ・ユーザー受入テストの実施<br>・業務要件の検証<br>・必要に応じたフィードバック提供 |

## 3. テスト実施フレームワークとツール

### 3.1 テストフレームワーク

各テストレベルで使用するフレームワークとツール：

| テストレベル | 言語/フレームワーク | 補助ツール |
|------------|-------------------|----------|
| 単体テスト | ・JUnit 5<br>・Mockito<br>・AssertJ | ・JaCoCo（カバレッジ計測） |
| 統合テスト | ・JUnit 5<br>・Spring Test<br>・Testcontainers<br>・REST Assured | ・Wiremock（外部サービスモック） |
| E2Eテスト | ・Playwright<br>・Cucumber | ・Allure（レポーティング） |
| セキュリティテスト | ・OWASP ZAP<br>・SonarQube | ・DependencyTrack（依存関係スキャン） |
| 性能テスト | ・JMeter<br>・Gatling | ・Prometheus（メトリクス収集）<br>・Grafana（可視化） |

### 3.2 CI/CDパイプラインでのテスト統合

テストはGitHub Actionsを用いたCI/CDパイプラインに統合し、以下のワークフローで実行する：

1. **Pull Request作成時**:
   - 単体テスト実行
   - 統合テスト実行（軽量セット）
   - コードカバレッジチェック
   - 静的コード解析（SonarQube）
   - 依存関係セキュリティチェック

2. **メインブランチマージ後**:
   - 単体テスト実行
   - 統合テスト実行（完全セット）
   - E2Eテスト実行
   - セキュリティスキャン
   - ステージング環境へのデプロイ

3. **リリース前**:
   - 全てのテスト再実行
   - 性能テスト実行
   - ユーザー受入テスト環境準備

### 3.3 テスト成果物

テスト活動で作成・管理する主要成果物：

| 成果物 | 説明 | 作成者 | 承認者 |
|-------|------|-------|-------|
| テスト計画書 | 各テストレベルの詳細計画 | QAリード | プロジェクトマネージャ |
| テストケース | 検証項目と期待結果の定義 | 開発者、QAエンジニア | QAリード |
| テストスクリプト | 自動化されたテストコード | 開発者、QAエンジニア | テックリード |
| テスト結果レポート | テスト実行結果の要約と分析 | QAエンジニア | QAリード、プロジェクトマネージャ |
| 不具合管理リスト | 検出された不具合と対応状況 | QAエンジニア | 未承認（情報共有用） |
| テストカバレッジレポート | コードカバレッジの測定結果 | 自動生成 | テックリード |

## 4. テスト品質指標とターゲット

### 4.1 品質指標

以下の指標でテスト品質を評価する：

| 指標 | 説明 | 測定ツール | 目標値 |
|-----|------|----------|-------|
| コードカバレッジ | テストで実行されたコードの割合 | JaCoCo | 全体：80%以上<br>重要モジュール：90%以上 |
| テストケース実行率 | 計画されたテストケースの実行割合 | テスト管理ツール | 100% |
| 欠陥密度 | KLOCあたりの検出不具合数 | 不具合管理ツール | 開発フェーズ：最大10件/KLOC<br>リリース時：最大0.5件/KLOC |
| 欠陥検出効率 | テスト工数あたりの検出不具合数 | 不具合管理ツール+工数記録 | N/A（トレンド分析のみ） |
| 欠陥除去率 | 発見された不具合の修正割合 | 不具合管理ツール | 重大度「高」以上：100%<br>重大度「中」：95%以上<br>重大度「低」：80%以上 |
| 自動化率 | 自動化されたテストケースの割合 | テスト管理ツール | 単体/統合テスト：95%以上<br>E2Eテスト：80%以上 |
| 平均修正時間 | 不具合発見から修正までの平均時間 | 不具合管理ツール | 重大度「高」：1営業日以内<br>重大度「中」：3営業日以内<br>重大度「低」：次期リリースまで |

### 4.2 テスト終了・移行基準

各テストフェーズの終了基準と次フェーズへの移行基準：

| フェーズ | 終了基準 | 移行基準 |
|---------|---------|---------|
| 単体テスト | ・全単体テスト合格<br>・カバレッジ80%以上<br>・コードレビュー承認済み | 単体テスト終了基準を満たす |
| 統合テスト | ・全統合テスト合格<br>・重大度「高」以上の不具合がないこと<br>・外部連携が正常に機能すること | 統合テスト終了基準を満たし、関連する全機能の単体テストが完了 |
| E2Eテスト | ・ビジネスシナリオの95%以上の合格<br>・重大度「高」以上の不具合がないこと<br>・重大度「中」の未修正不具合が3件以下 | E2Eテスト終了基準を満たし、関連する全機能の統合テストが完了 |
| セキュリティテスト | ・重大な脆弱性がないこと<br>・中程度の脆弱性の対応計画が承認されていること | 別途セキュリティ評価会議で判断 |
| 性能テスト | ・非機能要件を満たしていること<br>・特定されたボトルネックの対応が完了または計画済みであること | 別途性能評価会議で判断 |
| ユーザー受入テスト | ・全テスト項目の90%以上が合格<br>・重大度「高」以上の不具合がないこと<br>・残存する不具合の対応計画が承認されていること | 業務責任者の承認と残課題の対応計画が示されること |

## 5. テスト実施プロセス

### 5.1 テスト計画

テスト計画のプロセス：

1. 要件・仕様の分析
2. テスト戦略の決定
3. テストレベルと範囲の定義
4. リソースと日程計画
5. テストケース識別と優先順位付け
6. 環境要件の定義
7. リスク分析と対策計画
8. 計画書の作成とレビュー

### 5.2 テスト設計

テスト設計のプロセス：

1. テスト対象分析
2. テスト条件の識別
3. テストケースの設計
   - 同値分割
   - 境界値分析
   - デシジョンテーブル
   - 状態遷移テスト
   - ユースケーステスト
4. テストデータの準備
5. テスト手順の作成
6. 自動化スクリプトの設計

### 5.3 テスト実行

テスト実行のプロセス：

1. テスト環境の準備と検証
2. テストデータのセットアップ
3. テストケースの実行
4. 結果の記録
5. 不具合の報告
6. 不具合の修正と再テスト
7. リグレッションテスト
8. 進捗状況の報告

### 5.4 テスト報告

テスト報告のプロセス：

1. テスト結果の集計・分析
2. 指標の測定と評価
3. 未解決課題のまとめ
4. リスク評価
5. 推奨事項の提示
6. 報告書の作成
7. 関係者との結果共有
8. 最終判断のための材料提供

## 6. テスト管理

### 6.1 テスト資産管理

テスト資産の管理方針：

- すべてのテストコードはソースコードリポジトリで管理
- テストデータはgitignoreに追加し、セキュリティ保護されたストレージで別途管理
- テスト設計書はソースコード隣接の`/docs`配下で管理
- テスト結果や不具合報告は指定のテスト管理ツールで保管

### 6.2 課題・不具合管理

不具合報告の基本情報：

- 不具合ID
- タイトル
- 詳細説明
- 再現手順
- 期待される結果
- 実際の結果
- スクリーンショット
- 環境情報
- 重大度と優先度
- 担当者
- ステータス

不具合管理プロセス：

1. 不具合の発見と報告
2. トリアージと優先度付け
3. 担当者へのアサイン
4. 再現と原因分析
5. 修正
6. レビューと確認テスト
7. クローズ

### 6.3 変更管理

テスト資産の変更管理：

- 機能変更に伴うテストケース更新
- テスト基準や手順の変更
- テスト自動化戦略・ツールの変更
- 環境構成の変更

すべての変更は正式なレビューと承認プロセスを経て実施する。

## 7. リスクと対策

### 7.1 テストにおける主要リスク

| リスク | 影響 | 確率 | 対策 |
|-------|------|-----|------|
| テスト環境の整備遅延 | 高 | 中 | ・クラウド環境を活用した迅速な環境構築<br>・開発早期からの環境要件定義 |
| テスト自動化の技術的課題 | 中 | 中 | ・POC実施による検証<br>・外部専門家の活用<br>・チーム育成計画 |
| テストデータ準備の遅延 | 高 | 中 | ・テストデータ生成ツールの導入<br>・早期からのデータ要件定義 |
| テスト実行時間の長期化 | 中 | 高 | ・並列テスト実行<br>・テスト優先順位付け<br>・CI/CDパイプラインの最適化 |
| テスト網羅性の不足 | 高 | 中 | ・カバレッジ測定の徹底<br>・リスクベースのテスト設計<br>・第三者レビュー |

### 7.2 緊急時対応計画

テスト中に重大な問題が発見された場合の対応：

1. 問題の初期評価と関係者への通知
2. 緊急対応チームの編成
3. 原因分析と影響範囲調査
4. 修正計画の策定
5. 修正と検証
6. 再発防止策の立案

## 8. その他

### 8.1 チーム構成と役割

| ロール | 担当者数 | 主な責任 |
|-------|---------|---------|
| テストマネージャ | 1名 | テスト全体の計画・管理・報告 |
| QAリード | 1名 | テスト仕様策定、レビュー、品質評価 |
| QAエンジニア | 3名 | テスト設計・実行・不具合報告 |
| 自動化エンジニア | 2名 | テスト自動化フレームワーク構築・運用 |
| セキュリティテスター | 1名 | セキュリティテスト計画・実行・評価 |
| 性能テストエンジニア | 1名 | 性能テスト計画・実行・分析 |

### 8.2 トレーニング計画

テストチームに必要なトレーニング：

- テスト技法基礎
- 自動化フレームワーク（JUnit、Playwright等）
- CI/CDパイプライン
- セキュリティテスト基礎
- 性能テスト・分析手法

### 8.3 改善計画

テストプロセス改善の取り組み：

- スプリント毎のテストレトロスペクティブ
- テスト指標の定期的な分析とフィードバック
- テスト自動化率の段階的向上
- テスト環境のセットアップ時間短縮
- ツール・手法の定期的な評価と改善

## 9. 付録

### 9.1 用語集

- **CI/CD**: 継続的インテグレーション/継続的デリバリー
- **E2E**: エンドツーエンドテスト
- **モック**: 外部依存を模倣するためのテスト用コンポーネント
- **スタブ**: 最小限の機能を持つテスト用コンポーネント
- **カバレッジ**: コードがテストによって実行される割合
- **リグレッションテスト**: 既存機能への影響確認のためのテスト

### 9.2 参考資料

- JUnit 5公式ドキュメント: https://junit.org/junit5/docs/current/user-guide/
- Spring Test Framework: https://docs.spring.io/spring-framework/docs/current/reference/html/testing.html
- OWASP Testing Guide: https://owasp.org/www-project-web-security-testing-guide/
- Google Testing Blog: https://testing.googleblog.com/

### 9.3 テンプレート・チェックリスト

- テストケース設計テンプレート
- バグ報告テンプレート
- テスト環境チェックリスト
- リリース判定チェックリスト