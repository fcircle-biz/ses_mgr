# SES業務システム セキュリティテスト計画

## 1. はじめに

### 1.1 目的

本ドキュメントは、SES業務システムに対するセキュリティテストの詳細計画を定義する。システムが適切なセキュリティ対策を実装し、既知の脆弱性から保護されていることを確認するための体系的なアプローチを提供する。

### 1.2 範囲

本セキュリティテスト計画は、以下の範囲を対象とする：

- Webアプリケーション（フロントエンド・バックエンド）
- REST API
- 認証・認可機能
- データ保護機能
- インフラストラクチャ設定
- DevOpsパイプライン
- 第三者ライブラリ・フレームワーク

なお、以下は本セキュリティテスト計画の対象外とする：

- 物理的セキュリティ対策
- クラウドプロバイダが管理するインフラ部分
- 開発者端末・ネットワーク

### 1.3 参照ドキュメント

- [テスト方針概要](/docs/03_詳細設計/06_テスト/01_テスト方針/テスト方針概要.md)
- [セキュリティ設計概要](/docs/03_詳細設計/05_セキュリティ/01_セキュリティ設計概要.md)
- [認証認可設計](/docs/03_詳細設計/05_セキュリティ/02_認証認可設計.md)
- [データ保護設計](/docs/03_詳細設計/05_セキュリティ/03_データ保護設計.md)
- [通信セキュリティ設計](/docs/03_詳細設計/05_セキュリティ/04_通信セキュリティ設計.md)
- [監査ログ設計](/docs/03_詳細設計/05_セキュリティ/05_監査ログ設計_01_概要.md)
- [脆弱性対策設計](/docs/03_詳細設計/05_セキュリティ/06_脆弱性対策設計.md)

## 2. セキュリティテスト戦略

### 2.1 テストアプローチ

セキュリティテストは以下の多層的アプローチで実施する：

1. **静的アプリケーションセキュリティテスト (SAST)**
   - ソースコード解析によるセキュリティ脆弱性の特定
   - セキュアコーディング規約の遵守確認
   - 依存ライブラリの脆弱性スキャン

2. **動的アプリケーションセキュリティテスト (DAST)**
   - 実行中のアプリケーションに対する脆弱性スキャン
   - エンドポイントセキュリティの検証
   - 認証・認可メカニズムの検証

3. **ペネトレーションテスト**
   - セキュリティ専門家による手動テスト
   - 脆弱性の検証と悪用可能性の評価
   - 複合的な攻撃シナリオの検証

4. **コンプライアンス検証**
   - 業界標準・法規制への準拠確認
   - セキュリティポリシーの遵守確認
   - プライバシー要件の充足確認

### 2.2 セキュリティテスト種別と頻度

| テスト種別 | 実施頻度 | 自動/手動 | 実施者 | 実施環境 |
|---------|--------|---------|-------|--------|
| SAST (静的解析) | 毎コミット | 自動 | CI/CD | ビルドパイプライン |
| 依存関係脆弱性スキャン | 毎日 | 自動 | CI/CD | ビルドパイプライン |
| DAST (動的スキャン) | 週1回 | 自動 | セキュリティチーム | テスト環境 |
| セキュリティAPI検証 | スプリント毎 | 自動 | 開発者 | テスト環境 |
| アクセス制御テスト | スプリント毎 | 半自動 | QAチーム | テスト環境 |
| インフラセキュリティスキャン | 週1回 | 自動 | インフラチーム | 全環境 |
| ペネトレーションテスト | 四半期毎 | 手動 | 外部専門家 | ステージング環境 |
| セキュリティコードレビュー | 主要機能実装時 | 手動 | セキュリティチーム | - |
| インシデント対応訓練 | 半年毎 | 手動 | 全チーム | 訓練環境 |

### 2.3 セキュリティテストツール

使用するセキュリティテストツール：

| カテゴリ | ツール | 用途 |
|---------|------|-----|
| SAST | SonarQube | コード品質とセキュリティ脆弱性の静的分析 |
| SAST | SpotBugs + FindSecBugs | Javaコードのセキュリティバグ検出 |
| 依存関係管理 | OWASP Dependency Check | オープンソース依存関係の脆弱性検出 |
| 依存関係管理 | Snyk | ライブラリ脆弱性検出と修正提案 |
| DAST | OWASP ZAP | 動的Webアプリケーションセキュリティテスト |
| DAST | Burp Suite Professional | 高度な動的セキュリティテスト |
| API検証 | Postman + Newman | APIセキュリティテストの自動化 |
| インフラスキャン | Trivy | コンテナイメージの脆弱性スキャン |
| ネットワークスキャン | Nessus | ネットワークとホストの脆弱性スキャン |
| シークレット管理 | GitLeaks | ソースコード内の機密情報検出 |
| 認証テスト | OWASP JWT Toolkit | JWT実装の脆弱性検出 |
| セキュリティ監視 | ELK Stack | セキュリティログの集中管理と分析 |

## 3. セキュリティ要件と検証方法

### 3.1 認証・認可セキュリティ

#### 3.1.1 検証項目

| ID | 要件 | 検証方法 | ツール |
|----|-----|---------|-------|
| AUTH-01 | JWT実装の安全性確保 | トークン生成・検証ロジックのコードレビュー<br>JWT実装の脆弱性テスト | OWASP JWT Toolkit |
| AUTH-02 | パスワードポリシー実装 | 弱いパスワードでのユーザー登録試行<br>ブルートフォース攻撃シミュレーション | カスタムスクリプト |
| AUTH-03 | 多要素認証の正常動作 | MFAバイパス試行<br>MFAフロー全体のテスト | 手動テスト |
| AUTH-04 | アカウントロックアウト機能 | 連続ログイン失敗テスト<br>ロックアウト回避試行 | カスタムスクリプト |
| AUTH-05 | ロールベースアクセス制御 | 権限昇格試行<br>認可バイパス試行 | OWASP ZAP, 手動テスト |
| AUTH-06 | セッション管理の安全性 | セッション固定攻撃試行<br>セッションタイムアウトテスト | Burp Suite |
| AUTH-07 | トークン無効化の検証 | ログアウト後のトークン使用試行<br>パスワード変更後のトークン検証 | カスタムスクリプト |

#### 3.1.2 テストケース例

```
テストID: AUTH-02-01
テスト名: パスワードポリシー実装検証
前提条件: テスト用ユーザーアカウントが存在しない
手順:
1. 以下のパターンでユーザー登録を試行：
   - 短すぎるパスワード（9文字）
   - 複雑さ不足（大文字なし）
   - 複雑さ不足（数字なし）
   - 複雑さ不足（特殊文字なし）
   - 一般的なパスワード（「Password123!」等）
2. 各ケースでエラーメッセージを確認
期待結果: 
- すべてのケースで登録が拒否される
- エラーメッセージがポリシー違反の内容を具体的に示す
- ログにパスワードポリシー違反が記録される
```

### 3.2 入力検証とデータ出力

#### 3.2.1 検証項目

| ID | 要件 | 検証方法 | ツール |
|----|-----|---------|-------|
| INPUT-01 | SQLインジェクション対策 | SQLインジェクションペイロード送信<br>パラメータ化クエリの使用確認 | OWASP ZAP, SQLmap |
| INPUT-02 | クロスサイトスクリプティング対策 | XSSペイロード送信<br>出力エンコーディング検証 | OWASP ZAP, XSS Hunter |
| INPUT-03 | クロスサイトリクエストフォージェリ対策 | CSRFトークン検証<br>CSRF攻撃シミュレーション | OWASP ZAP, Burp Suite |
| INPUT-04 | コマンドインジェクション対策 | OSコマンドインジェクション試行<br>入力サニタイズ検証 | OWASP ZAP |
| INPUT-05 | セキュアなデシリアライゼーション | 悪意あるシリアライズデータ送信<br>デシリアライズロジック検証 | 手動テスト |
| INPUT-06 | サーバーサイドリクエストフォージェリ対策 | SSRF攻撃試行<br>URLバリデーション検証 | Burp Suite |
| INPUT-07 | HTMLサニタイズ | 悪意あるHTML送信<br>サニタイズロジック検証 | XSS Hunter |

#### 3.2.2 テストケース例

```
テストID: INPUT-01-01
テスト名: SQLインジェクション対策検証
前提条件: テスト用アカウントでログイン済み
手順:
1. 以下のパラメータにSQLインジェクションペイロードを送信：
   - ログインフォーム（ユーザーID/パスワード）
   - 検索フォーム
   - 並べ替えパラメータ
   - IDパラメータ
2. 各エンドポイントでのレスポンスを分析
期待結果: 
- インジェクション試行が成功せず、エラーや例外が発生しない
- データベースクエリが実行されない
- インジェクション試行が監査ログに記録される
```

### 3.3 データ保護

#### 3.3.1 検証項目

| ID | 要件 | 検証方法 | ツール |
|----|-----|---------|-------|
| DATA-01 | 保存データの暗号化 | データベース内のデータ検査<br>暗号化実装の検証 | 手動検査 |
| DATA-02 | 通信の暗号化 | TLS設定の検証<br>安全でないプロトコルの検出 | SSL Labs, Nmap |
| DATA-03 | 機密データのマスキング | ログ・画面表示の検証<br>データマスキングロジックのテスト | 手動テスト |
| DATA-04 | 安全なファイルアップロード | 悪意あるファイルのアップロード試行<br>ファイルバリデーション検証 | OWASP ZAP |
| DATA-05 | データアクセス制御 | 権限外データアクセス試行<br>水平特権昇格試行 | 手動テスト |
| DATA-06 | セキュアなキー管理 | 暗号鍵の保護検証<br>キー管理プロセスのレビュー | 手動テスト |
| DATA-07 | 機密情報の流出防止 | エラーメッセージからの情報漏洩検証<br>ヘッダー情報漏洩検証 | OWASP ZAP, Burp Suite |

#### 3.3.2 テストケース例

```
テストID: DATA-03-01
テスト名: 機密データのマスキング検証
前提条件: テスト用アカウントでログイン済み、テスト用の個人情報が存在
手順:
1. 以下の機能で個人情報の表示を確認：
   - 技術者情報画面
   - 検索結果一覧
   - ログ（管理者アクセス）
   - APIレスポンス
2. 各表示でのマスキング状態を確認
期待結果: 
- 以下の情報が適切にマスキングされている：
  - 個人番号（マイナンバー）: 完全マスク
  - クレジットカード番号: 先頭4桁・末尾4桁以外マスク
  - 電話番号: 中間4桁マスク
  - メールアドレス: ローカル部分の一部マスク
- 権限によって適切にマスキング解除されている
```

### 3.4 APIセキュリティ

#### 3.4.1 検証項目

| ID | 要件 | 検証方法 | ツール |
|----|-----|---------|-------|
| API-01 | API認証の安全性 | 認証バイパス試行<br>トークン操作試行 | Postman, Burp Suite |
| API-02 | レート制限の実装 | レート制限超過試行<br>制限回避試行 | カスタムスクリプト |
| API-03 | エラー処理の安全性 | 異常入力での動作検証<br>エラーレスポンス解析 | Postman |
| API-04 | APIエンドポイントの検出 | 隠しエンドポイントの検索<br>メソッド許可検証 | OWASP ZAP |
| API-05 | HTTP メソッド制限 | 不正なHTTPメソッド試行<br>メソッドオーバーライド試行 | Burp Suite |
| API-06 | リソースアクセス制御 | 権限外リソースアクセス試行<br>IDの推測・操作試行 | Postman, カスタムスクリプト |
| API-07 | 大量データリクエスト対策 | 大容量ペイロード送信<br>ネスト深度検証 | カスタムスクリプト |

#### 3.4.2 テストケース例

```
テストID: API-02-01
テスト名: APIレート制限検証
前提条件: テスト用APIキーが発行済み
手順:
1. 以下のパターンでAPI呼び出しを実行：
   - 短時間（1秒間）に100リクエスト
   - 1分間に連続500リクエスト
   - 複数IPアドレスからの同時リクエスト
2. レスポンスとヘッダーを分析
期待結果: 
- 制限超過時に429 Too Many Requestsが返却される
- レスポンスヘッダーにリミット情報が含まれる
- 制限超過が監査ログに記録される
- リクエスト元IPアドレスごとに制限が適用される
```

### 3.5 インフラストラクチャセキュリティ

#### 3.5.1 検証項目

| ID | 要件 | 検証方法 | ツール |
|----|-----|---------|-------|
| INFRA-01 | コンテナセキュリティ | コンテナイメージの脆弱性スキャン<br>コンテナ設定検証 | Trivy, Docker Bench |
| INFRA-02 | サーバー設定の安全性 | サーバーハードニングチェック<br>不要サービス確認 | Nessus |
| INFRA-03 | ネットワークセキュリティ | ポートスキャン<br>ネットワーク分離確認 | Nmap |
| INFRA-04 | データベースセキュリティ | データベース設定検証<br>権限設定確認 | 手動チェック |
| INFRA-05 | クラウドセキュリティ | IAM権限検証<br>クラウドリソース設定検証 | AWS Config, Azure Security Center |
| INFRA-06 | シークレット管理 | 環境変数・設定ファイル検証<br>シークレットローテーション確認 | GitLeaks |
| INFRA-07 | CI/CDパイプラインセキュリティ | パイプライン権限検証<br>ビルド環境セキュリティ確認 | 手動チェック |

#### 3.5.2 テストケース例

```
テストID: INFRA-01-01
テスト名: コンテナイメージ脆弱性スキャン
前提条件: ビルド済みのコンテナイメージが存在
手順:
1. 全コンテナイメージに対してTrivyによる脆弱性スキャンを実行
2. 検出された脆弱性を重大度別に分類
3. 修正可能な脆弱性のリストを作成
期待結果: 
- 重大度「高」以上の脆弱性が存在しない
- 中程度の脆弱性が10件未満
- 検出された脆弱性に対する緩和策やアップグレード計画が存在する
```

### 3.6 監査・ロギング

#### 3.6.1 検証項目

| ID | 要件 | 検証方法 | ツール |
|----|-----|---------|-------|
| AUDIT-01 | セキュリティイベントのログ記録 | ログ内容の検証<br>ログ網羅性の確認 | 手動チェック |
| AUDIT-02 | ログの完全性保護 | ログ改ざん試行<br>ログ保存メカニズム検証 | 手動テスト |
| AUDIT-03 | 機密情報のログ漏洩防止 | ログ内容の検査<br>マスキングの検証 | 手動チェック |
| AUDIT-04 | 管理者操作の記録 | 特権操作のログ確認<br>ログ詳細度の検証 | 手動テスト |
| AUDIT-05 | 異常検知メカニズム | セキュリティイベント検知テスト<br>アラート発生確認 | カスタムスクリプト |
| AUDIT-06 | ログ保持期間遵守 | ログローテーション検証<br>保持期間確認 | 手動チェック |
| AUDIT-07 | 監査証跡の生成 | 監査レポート生成確認<br>フォレンジック対応確認 | 手動テスト |

#### 3.6.2 テストケース例

```
テストID: AUDIT-01-01
テスト名: セキュリティイベントログ記録検証
前提条件: テスト用アカウントが用意されている
手順:
1. 以下のセキュリティイベントを発生させる：
   - ログイン成功/失敗
   - パスワード変更
   - パスワードリセット要求
   - ユーザー権限変更
   - 重要データアクセス
   - 管理機能使用
2. ログを検査し、各イベントの記録を確認
期待結果: 
- すべてのセキュリティイベントがログに記録されている
- ログには以下の情報が含まれる：
  - タイムスタンプ（ミリ秒精度）
  - イベント種別
  - ユーザーID
  - IPアドレス
  - セッションID
  - 操作内容（適切な詳細度）
- 機密情報（パスワード等）はログに記録されていない
```

## 4. 特定のセキュリティテスト詳細

### 4.1 ペネトレーションテスト

#### 4.1.1 ペネトレーションテスト範囲

ペネトレーションテストは以下の範囲で実施する：

1. **外部ペネトレーションテスト**
   - 外部からアクセス可能なWebアプリケーション
   - 公開API
   - 認証メカニズム

2. **内部ペネトレーションテスト**
   - 内部ネットワーク
   - ユーザーアクセス制御
   - サービス間通信

3. **特権昇格テスト**
   - 認可メカニズム
   - ロール管理
   - 水平・垂直特権昇格

#### 4.1.2 ペネトレーションテスト除外事項

以下の項目はペネトレーションテストの対象外とする：

- DoS（サービス拒否）攻撃
- 物理的セキュリティテスト
- ソーシャルエンジニアリング
- 生産システムのデータ破壊を伴うテスト

#### 4.1.3 ペネトレーションテスト実施プロセス

1. **事前計画**
   - スコープとターゲットの明確化
   - テスト方法と制約の定義
   - スケジュールの確定

2. **情報収集**
   - パブリック情報調査
   - ネットワークとシステム情報の収集
   - 技術スタックの特定

3. **脆弱性スキャン**
   - 自動スキャンツールの実行
   - 初期脆弱性評価

4. **手動テスト**
   - 発見された脆弱性の検証
   - 複雑な攻撃シナリオのテスト
   - 特化した手法によるテスト

5. **文書化と報告**
   - 発見した脆弱性の詳細記録
   - 影響度と対策の提案
   - 修正優先度の提案

### 4.2 セキュアコードレビュー

#### 4.2.1 レビュー対象領域

以下の領域のコードを優先的にレビューする：

1. **認証・認可関連コード**
   - ログインロジック
   - セッション管理
   - アクセス制御

2. **データ処理コード**
   - 入力バリデーション
   - データベースアクセス
   - ファイル操作

3. **セキュリティ重要機能**
   - 暗号化処理
   - API実装
   - 例外処理

#### 4.2.2 レビュー基準

コードレビューでは以下の基準を適用する：

1. **セキュアコーディング規約準拠**
   - OWASP Secure Coding Practices
   - 言語固有のセキュリティベストプラクティス

2. **一般的な脆弱性の不在**
   - インジェクション攻撃対策
   - 認証・認可の適切な実装
   - 安全なデータ処理

3. **セキュリティ設計に準拠した実装**
   - 設計書に記載されたセキュリティコントロールの実装
   - セキュリティ要件の充足

### 4.3 セキュリティ設定検証

#### 4.3.1 検証対象

以下の設定を検証する：

1. **アプリケーション設定**
   - Webサーバー設定
   - フレームワーク設定
   - セキュリティヘッダー設定

2. **インフラストラクチャ設定**
   - ファイアウォールルール
   - ネットワークアクセス制御
   - クラウドサービス設定

3. **データベース設定**
   - アクセス権限
   - ネットワーク接続設定
   - 監査設定

#### 4.3.2 検証方法

セキュリティ設定を以下の方法で検証する：

1. **構成ファイル検査**
   - 設定ファイルの静的分析
   - セキュリティ推奨設定との比較

2. **自動スキャン**
   - インフラスキャンツールの実行
   - セキュリティベンチマークテスト

3. **手動検証**
   - 設定の動作確認
   - セキュリティコントロールの有効性テスト

## 5. セキュリティバグ・脆弱性の評価と管理

### 5.1 脆弱性の重大度評価

発見されたセキュリティ問題は以下の基準で評価する：

#### 5.1.1 評価基準

| 重大度 | 説明 | 例 |
|-------|------|-----|
| クリティカル | システム全体に重大な影響を与える<br>直ちに対応が必要 | リモートコード実行<br>認証バイパス<br>データベース全体漏洩 |
| 高 | 特定機能・データに深刻な影響<br>優先的に対応が必要 | SQLインジェクション<br>アカウント乗っ取り<br>機密情報漏洩 |
| 中 | 特定条件下でリスクとなる<br>計画的な対応が必要 | クロスサイトスクリプティング（反射型）<br>一部情報漏洩<br>セッション固定 |
| 低 | リスクは限定的<br>優先度は低い | HTTPヘッダー情報漏洩<br>エラーメッセージからの情報漏洩<br>非セキュアCookie |
| 情報 | 直接的なリスクはないが注意点 | 古いライブラリの使用<br>ベストプラクティス違反<br>セキュリティ強化の提案 |

#### 5.1.2 CVSS評価

Common Vulnerability Scoring System (CVSS v3.1) を使用して脆弱性を定量的に評価する。

- 基本評価指標（攻撃ベクトル、複雑さ、必要な権限等）
- 現状評価指標（対策のレベル、検出可能性等）
- 環境評価指標（ビジネスへの影響等）

CVSSスコアとリスク評価の対応：
- 9.0-10.0: クリティカル
- 7.0-8.9: 高
- 4.0-6.9: 中
- 0.1-3.9: 低

### 5.2 修正優先度と期限

脆弱性の重大度に基づく修正優先度と期限：

| 重大度 | 修正期限 | レビュー要件 |
|-------|---------|------------|
| クリティカル | 24時間以内 | セキュリティチームによる緊急レビュー |
| 高 | 3営業日以内 | セキュリティチームによるレビュー |
| 中 | 2週間以内 | 通常のコードレビュープロセス |
| 低 | 次期リリース | 通常のコードレビュープロセス |
| 情報 | リソース状況に応じて | - |

### 5.3 脆弱性管理フロー

発見されたセキュリティ問題の管理プロセス：

1. **脆弱性発見・報告**
   - 自動テスト、手動テスト、外部報告等
   - 詳細な再現手順の記録

2. **トリアージと評価**
   - 重大度・影響範囲の評価
   - 優先度の決定

3. **対応計画**
   - 修正担当者のアサイン
   - 修正期限の設定
   - 一時的な緩和策の検討

4. **修正実装**
   - 脆弱性の根本原因対処
   - 類似箇所の確認

5. **検証テスト**
   - 修正の有効性確認
   - 回帰テスト

6. **クローズ**
   - 最終承認
   - 知識ベースへの追加

### 5.4 報告テンプレート

セキュリティ脆弱性レポートには以下の情報を含める：

- **概要**: 脆弱性のタイトルと簡潔な説明
- **影響度**: 重大度評価とCVSSスコア
- **影響範囲**: 影響を受けるコンポーネント・機能
- **技術的詳細**: 脆弱性の詳細な説明
- **再現手順**: 脆弱性を再現するための詳細な手順
- **対策提案**: 推奨される対策または修正方法
- **参考情報**: 関連するCVE、記事、ベストプラクティス

## 6. 実施計画とスケジュール

### 6.1 全体スケジュール

| フェーズ | 開始 | 終了 | 成果物 |
|---------|------|------|-------|
| 計画と準備 | 2025/07/10 | 2025/07/20 | テスト環境準備、テストシナリオ |
| 自動セキュリティテスト設定 | 2025/07/21 | 2025/08/05 | CI/CD統合、自動スキャン設定 |
| 初回セキュリティスキャン | 2025/08/06 | 2025/08/15 | 初期セキュリティ評価レポート |
| 修正と再テスト | 2025/08/16 | 2025/09/05 | 修正確認レポート |
| ペネトレーションテスト | 2025/09/06 | 2025/09/25 | ペネトレーションテストレポート |
| 最終評価とドキュメント化 | 2025/09/26 | 2025/10/05 | 最終セキュリティ評価レポート |

### 6.2 責任分担

| 役割 | 担当者 | 責任範囲 |
|------|-------|---------|
| セキュリティリード | セキュリティチーム | 全体計画、評価基準策定、最終評価 |
| SAST担当 | 開発チーム | 静的分析設定、実行、結果評価 |
| DAST担当 | QAチーム | 動的スキャン実行、結果分析 |
| ペンテスター | 外部専門家 | ペネトレーションテスト実施、レポート作成 |
| 修正担当 | 開発チーム | 脆弱性修正実装、修正検証 |
| インフラセキュリティ担当 | インフラチーム | インフラスキャン、設定検証 |
| コンプライアンス担当 | 法務・コンプライアンスチーム | 規制要件評価、証跡管理 |

## 7. セキュリティテスト報告

### 7.1 報告書の構成

セキュリティテスト報告書の基本構成：

1. **エグゼクティブサマリー**
   - 全体的なセキュリティ状況
   - 重要な発見事項
   - リスク評価

2. **テスト概要**
   - テスト範囲
   - 実施期間
   - 使用したツール・方法

3. **発見事項詳細**
   - 脆弱性の詳細説明
   - 重大度評価
   - 再現手順
   - 影響分析

4. **リスク評価**
   - 全体的なセキュリティリスク評価
   - 最も重要なリスク領域
   - リスク軽減のための推奨事項

5. **修正ステータス**
   - 発見された脆弱性の対応状況
   - 未対応項目とタイムライン
   - 再テスト結果

6. **付録**
   - 詳細なスキャン結果
   - スクリーンショット
   - 技術的参考資料

### 7.2 受入基準

セキュリティテストの受入基準：

| 重大度 | 受入基準 |
|-------|---------|
| クリティカル | すべての脆弱性が修正され、再テストで確認されていること |
| 高 | すべての脆弱性が修正されるか、承認された緩和策が実施されていること |
| 中 | 80%以上の脆弱性が修正され、残りに対する計画が承認されていること |
| 低 | 50%以上の脆弱性が修正され、残りに対する計画が承認されていること |
| 情報 | 対応計画が検討されていること |

追加的な受入基準：
- OWASP Top 10脆弱性が存在しないこと
- 規制コンプライアンス要件を満たしていること
- セキュリティログが適切に実装されていること
- セキュリティインシデント対応プロセスが文書化されていること

## 8. インシデント対応

### 8.1 テスト中のインシデント対応

テスト中に重大な脆弱性が発見された場合の対応：

1. **即時報告**
   - セキュリティリードと開発責任者への報告
   - 影響範囲の初期評価

2. **緊急トリアージ**
   - 重大度と影響範囲の詳細評価
   - 緊急対応の必要性判断

3. **一時的緩和**
   - 機能の一時停止
   - ワークアラウンドの実装
   - アクセス制限

4. **根本修正**
   - 優先的な修正実装
   - 緊急リリース計画

5. **事後レビュー**
   - インシデント対応の評価
   - 類似脆弱性の検索
   - 再発防止策の検討

### 8.2 脆弱性開示ポリシー

セキュリティテスト中に発見された脆弱性の開示ポリシー：

1. **社内開示**
   - 必要最小限の関係者のみに開示
   - 詳細な技術情報は限定共有

2. **ベンダー開示**
   - 使用ソフトウェアの脆弱性発見時、ベンダーへの責任ある開示
   - 90日間の修正猶予期間の提供

3. **顧客開示**
   - 修正完了後、影響を受ける顧客に開示
   - 必要に応じた更新情報の提供

4. **公開開示**
   - 公開リスクがある場合のみ、修正完了後に公開
   - 技術的詳細の制限

## 9. ツールと環境設定

### 9.1 OWASP ZAP設定

```
# ZAP自動スキャン設定例
zap-cli quick-scan --self-contained \
                   --start-options '-config api.disablekey=true -config scanner.attackOnStart=true' \
                   --spider \
                   --ajax-spider \
                   --full-scan \
                   -r テスト対象URL
```

### 9.2 SonarQube設定

```xml
<!-- sonar-project.properties -->
sonar.projectKey=ses_mgr
sonar.projectName=SES管理システム
sonar.projectVersion=1.0

sonar.sources=src/main
sonar.tests=src/test
sonar.java.binaries=target/classes

# セキュリティ関連設定
sonar.security.sources.exclusions=
sonar.security.sanitizers=
sonar.security.sinks=
```

### 9.3 OWASP Dependency Check設定

```xml
<plugin>
    <groupId>org.owasp</groupId>
    <artifactId>dependency-check-maven</artifactId>
    <version>7.4.0</version>
    <configuration>
        <failBuildOnCVSS>7</failBuildOnCVSS>
        <formats>
            <format>HTML</format>
            <format>JSON</format>
        </formats>
    </configuration>
    <executions>
        <execution>
            <goals>
                <goal>check</goal>
            </goals>
        </execution>
    </executions>
</plugin>
```

### 9.4 SpotBugs + FindSecBugs設定

```xml
<plugin>
    <groupId>com.github.spotbugs</groupId>
    <artifactId>spotbugs-maven-plugin</artifactId>
    <version>4.7.3.0</version>
    <configuration>
        <effort>Max</effort>
        <threshold>Low</threshold>
        <failOnError>true</failOnError>
        <plugins>
            <plugin>
                <groupId>com.h3xstream.findsecbugs</groupId>
                <artifactId>findsecbugs-plugin</artifactId>
                <version>1.12.0</version>
            </plugin>
        </plugins>
    </configuration>
    <executions>
        <execution>
            <id>security-check</id>
            <phase>verify</phase>
            <goals>
                <goal>check</goal>
            </goals>
        </execution>
    </executions>
</plugin>
```

## 10. 付録

### 10.1 セキュリティテストチェックリスト

| カテゴリ | チェック項目 | 優先度 |
|---------|------------|-------|
| 認証 | パスワードポリシー実装の検証 | 高 |
| 認証 | ブルートフォース対策の確認 | 高 |
| 認証 | MFA実装の検証 | 高 |
| 認証 | パスワードリセット機能の安全性 | 高 |
| 認証 | アカウントロックアウト機能 | 高 |
| 認可 | ロールベースアクセス制御の検証 | 高 |
| 認可 | 水平特権昇格対策の確認 | 高 |
| 認可 | 垂直特権昇格対策の確認 | 高 |
| 入力検証 | SQLインジェクション対策 | 高 |
| 入力検証 | XSS対策 | 高 |
| 入力検証 | CSRF対策 | 高 |
| 入力検証 | コマンドインジェクション対策 | 高 |
| 入力検証 | XXE対策 | 中 |
| 入力検証 | SSRF対策 | 中 |
| データ保護 | 機密データの暗号化 | 高 |
| データ保護 | 通信の暗号化（TLS） | 高 |
| データ保護 | 機密データのマスキング | 中 |
| データ保護 | 安全なファイルアップロード | 中 |
| セッション管理 | セッションタイムアウト | 中 |
| セッション管理 | セッション固定攻撃対策 | 中 |
| セッション管理 | 同時ログイン制限 | 中 |
| エラー処理 | 情報漏洩のないエラーメッセージ | 中 |
| エラー処理 | 例外ハンドリングの適切さ | 中 |
| 監査ログ | セキュリティイベントのログ記録 | 高 |
| 監査ログ | ログの改ざん保護 | 中 |
| 構成管理 | セキュアヘッダーの設定 | 中 |
| 構成管理 | 不要サービス・機能の無効化 | 中 |
| 構成管理 | デフォルト設定の変更 | 中 |
| 依存関係 | ライブラリの脆弱性チェック | 高 |
| 業務ロジック | ビジネスロジックの悪用対策 | 高 |

### 10.2 セキュリティテスト推奨ツール詳細

| ツール名 | 種類 | ライセンス | 特長 |
|---------|------|----------|------|
| OWASP ZAP | DAST | オープンソース | Webアプリケーション脆弱性スキャン、プロキシ機能 |
| SonarQube | SAST | オープンソース/商用 | コード品質とセキュリティの静的解析 |
| SpotBugs + FindSecBugs | SAST | オープンソース | Javaのセキュリティバグ検出 |
| OWASP Dependency Check | SCA | オープンソース | 依存ライブラリの脆弱性スキャン |
| Snyk | SCA/SAST | 商用/フリー版あり | 依存ライブラリと脆弱性の検出・修正 |
| Burp Suite | DAST | 商用/無料版あり | 高度なWebアプリケーション脆弱性テスト |
| Trivy | コンテナスキャン | オープンソース | コンテナイメージの脆弱性スキャン |
| Nessus | ネットワークスキャン | 商用 | 包括的な脆弱性スキャン |
| GitLeaks | シークレットスキャン | オープンソース | コード内の機密情報の検出 |
| OWASP ModSecurity CRS | WAF | オープンソース | Webアプリケーションファイアウォールルール |

### 10.3 参考資料

- [OWASP Testing Guide v4](https://owasp.org/www-project-web-security-testing-guide/stable/)
- [OWASP Application Security Verification Standard](https://owasp.org/www-project-application-security-verification-standard/)
- [NIST SP 800-115: Technical Guide to Information Security Testing and Assessment](https://csrc.nist.gov/publications/detail/sp/800-115/final)
- [OWASP Top 10 - 2021](https://owasp.org/Top10/)
- [SANS CWE Top 25 Most Dangerous Software Errors](https://www.sans.org/top25-software-errors/)
- [Mozilla Web Security Guidelines](https://infosec.mozilla.org/guidelines/web_security.html)
- [NIST Cybersecurity Framework](https://www.nist.gov/cyberframework)