# 国際化機能 - 概要

## 1. 目的と責務

国際化機能は、SES業務システム全体で異なる言語や地域設定に対応するための基盤機能です。主に以下の責務を担います：

- **多言語メッセージ管理**: システム全体で使用するテキストリソースの多言語対応
- **ロケール解決**: ユーザーの言語・地域設定の解決と管理
- **書式フォーマット**: 日付・時刻・数値・通貨のロケール依存フォーマット
- **データの国際化**: 多言語対応が必要なデータモデルの設計と実装
- **言語切り替え**: ユーザーによる言語・地域設定の変更機能提供

## 2. 対応言語と地域

### 2.1 対応言語

初期リリースでは以下の言語をサポートします：

- **日本語（ja）**: 主要言語
- **英語（en）**: 補助言語

将来的に以下の言語のサポートが予定されています：

- 中国語（繁体字/簡体字）（zh-TW/zh-CN）
- 韓国語（ko）

### 2.2 対応地域

以下の地域設定をサポートします：

- **日本（ja-JP）**: 日本国内向け
- **アメリカ合衆国（en-US）**: 北米地域向け
- **イギリス（en-GB）**: 欧州地域向け

### 2.3 地域依存の表示形式

|項目|ja-JP|en-US|en-GB|
|---|---|---|---|
|日付形式|yyyy/MM/dd|MM/dd/yyyy|dd/MM/yyyy|
|時刻形式|HH:mm|h:mm a|HH:mm|
|数値形式|1,234.56|1,234.56|1,234.56|
|通貨形式|¥1,234|$1,234.56|£1,234.56|

## 3. システムアーキテクチャ

### 3.1 全体アーキテクチャ

国際化機能は以下のコンポーネントから構成されます：

```
[Front-end]                               [Back-end]
+-----------------+                      +-------------------+
| React-Intl      | <--- REST API ---->  | Spring i18n       |
| (i18next)       |                      | (MessageSource)   |
+-----------------+                      +-------------------+
       |                                         |
       V                                         V
+-----------------+                      +-------------------+
| メッセージリソース |                      | メッセージリソース  |
| (JSON)          |                      | (Properties)      |
+-----------------+                      +-------------------+
       |                                         |
       V                                         V
+-----------------+                      +-------------------+
| フォーマッター    |                      | フォーマッター     |
| (Intl API)      |                      | (DateTimeFormat)  |
+-----------------+                      +-------------------+
```

### 3.2 主要コンポーネント

#### バックエンド（Spring）
- **MessageSource**: メッセージリソースへのアクセス
- **LocaleResolver**: リクエストからのロケール解決
- **LocaleChangeInterceptor**: ロケール変更の検出
- **MessageSourceAccessor**: コード内でのメッセージ参照簡素化
- **Formatter**: 日付・時刻・数値のロケール対応フォーマット

#### フロントエンド（React）
- **i18nコンテキスト**: 言語リソースと翻訳関数の提供
- **言語プロバイダー**: 言語状態と切り替え機能の提供
- **翻訳フック**: コンポーネント内での翻訳利用
- **フォーマットコンポーネント**: 日付・通貨などのフォーマット表示

### 3.3 データフロー

1. **ロケール解決フロー**:
   - リクエスト受信
   - ユーザーのロケールを解決（優先順位: ユーザー設定 > セッション > リクエストパラメータ > ブラウザ設定 > デフォルト）
   - ロケールをスレッドローカルに設定

2. **メッセージ解決フロー**:
   - メッセージキーと引数を受け取る
   - 現在のロケールを取得
   - ロケールに対応するメッセージリソースからメッセージを検索
   - メッセージが見つからない場合はデフォルトロケールで検索
   - メッセージを返却

3. **フォーマットフロー**:
   - フォーマット対象と形式を受け取る
   - 現在のロケールを取得
   - ロケールに対応するフォーマッタを使用
   - フォーマット結果を返却

## 4. 国際化機能の適用範囲

### 4.1 フロントエンド

- 画面表示テキスト（ラベル、ボタン、メニュー項目など）
- フォームのプレースホルダー
- エラーメッセージ
- ツールチップやヘルプテキスト
- 日付・時刻・数値・通貨の表示
- 並び替え（ソート）ロジック

### 4.2 バックエンド

- API応答メッセージ
- バリデーションメッセージ
- ログメッセージ（開発・運用向け）
- メール通知内容
- レポート出力内容

### 4.3 データベース

- マスタデータの多言語対応
- ユーザー入力データの言語識別
- 検索インデックスの言語対応

## 5. 導入戦略

### 5.1 フェーズ分け

1. **Phase 1**: 基盤機能の実装
   - メッセージリソース管理機能
   - ロケール解決機能
   - 主要画面の多言語対応

2. **Phase 2**: 業務機能の多言語対応
   - 案件管理
   - 技術者管理
   - 契約管理

3. **Phase 3**: 高度な多言語対応
   - レポート出力
   - 通知機能
   - 検索機能

### 5.2 優先順位

- 最初にUI要素の多言語対応を実装
- 次にエラーメッセージの多言語対応を実装
- 最後にマスタデータの多言語対応を実装