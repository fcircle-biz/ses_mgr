<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Navigation Fragment</title>
</head>
<body>
    <nav th:fragment="navigation" class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" th:classappend="${activeMenu == 'dashboard' ? 'active' : ''}" 
                           th:href="@{/dashboard}">ダッシュボード</a>
                    </li>
                    
                    <!-- 案件管理 -->
                    <li class="nav-item dropdown" sec:authorize="hasAnyRole('ROLE_ADMIN', 'ROLE_SALES')">
                        <a class="nav-link dropdown-toggle" th:classappend="${activeMenu == 'project' ? 'active' : ''}"
                           href="#" id="projectDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            案件管理
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="projectDropdown">
                            <li><a class="dropdown-item" th:href="@{/projects}">案件一覧</a></li>
                            <li><a class="dropdown-item" th:href="@{/projects/new}">案件登録</a></li>
                        </ul>
                    </li>
                    
                    <!-- 技術者管理 -->
                    <li class="nav-item dropdown" sec:authorize="hasAnyRole('ROLE_ADMIN', 'ROLE_HR')">
                        <a class="nav-link dropdown-toggle" th:classappend="${activeMenu == 'engineer' ? 'active' : ''}"
                           href="#" id="engineerDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            技術者管理
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="engineerDropdown">
                            <li><a class="dropdown-item" th:href="@{/engineers}">技術者一覧</a></li>
                            <li><a class="dropdown-item" th:href="@{/engineers/new}">技術者登録</a></li>
                            <li><a class="dropdown-item" th:href="@{/engineers/skills}">スキルシート管理</a></li>
                        </ul>
                    </li>
                    
                    <!-- マッチング -->
                    <li class="nav-item" sec:authorize="hasAnyRole('ROLE_ADMIN', 'ROLE_SALES', 'ROLE_HR')">
                        <a class="nav-link" th:classappend="${activeMenu == 'matching' ? 'active' : ''}" 
                           th:href="@{/matching}">マッチング</a>
                    </li>
                    
                    <!-- 契約管理 -->
                    <li class="nav-item dropdown" sec:authorize="hasAnyRole('ROLE_ADMIN', 'ROLE_SALES')">
                        <a class="nav-link dropdown-toggle" th:classappend="${activeMenu == 'contract' ? 'active' : ''}"
                           href="#" id="contractDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            契約管理
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="contractDropdown">
                            <li><a class="dropdown-item" th:href="@{/contracts}">契約一覧</a></li>
                            <li><a class="dropdown-item" th:href="@{/contracts/new}">契約作成</a></li>
                            <li><a class="dropdown-item" th:href="@{/contracts/templates}">契約テンプレート</a></li>
                        </ul>
                    </li>
                    
                    <!-- 勤怠工数管理 -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" th:classappend="${activeMenu == 'timesheet' ? 'active' : ''}"
                           href="#" id="timesheetDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            勤怠工数管理
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="timesheetDropdown">
                            <li><a class="dropdown-item" th:href="@{/timesheet}">勤怠入力</a></li>
                            <li><a class="dropdown-item" th:href="@{/timesheet/approval}" sec:authorize="hasAnyRole('ROLE_ADMIN', 'ROLE_PM')">工数承認</a></li>
                            <li><a class="dropdown-item" th:href="@{/timesheet/report}" sec:authorize="hasAnyRole('ROLE_ADMIN', 'ROLE_SALES')">工数レポート</a></li>
                        </ul>
                    </li>
                    
                    <!-- 請求・支払管理 -->
                    <li class="nav-item dropdown" sec:authorize="hasAnyRole('ROLE_ADMIN', 'ROLE_ACCOUNTING')">
                        <a class="nav-link dropdown-toggle" th:classappend="${activeMenu == 'billing' ? 'active' : ''}"
                           href="#" id="billingDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            請求・支払
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="billingDropdown">
                            <li><a class="dropdown-item" th:href="@{/billing/invoices}">請求書管理</a></li>
                            <li><a class="dropdown-item" th:href="@{/billing/payments}">支払管理</a></li>
                        </ul>
                    </li>
                    
                    <!-- レポーティング -->
                    <li class="nav-item dropdown" sec:authorize="hasAnyRole('ROLE_ADMIN', 'ROLE_MANAGEMENT')">
                        <a class="nav-link dropdown-toggle" th:classappend="${activeMenu == 'reporting' ? 'active' : ''}"
                           href="#" id="reportingDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            レポート
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="reportingDropdown">
                            <li><a class="dropdown-item" th:href="@{/reporting/kpi}">KPIダッシュボード</a></li>
                            <li><a class="dropdown-item" th:href="@{/reporting/sales}">売上レポート</a></li>
                            <li><a class="dropdown-item" th:href="@{/reporting/profit}">粗利レポート</a></li>
                            <li><a class="dropdown-item" th:href="@{/reporting/utilization}">稼働率レポート</a></li>
                        </ul>
                    </li>
                    
                    <!-- 管理者メニュー -->
                    <li class="nav-item dropdown" sec:authorize="hasRole('ROLE_ADMIN')">
                        <a class="nav-link dropdown-toggle" th:classappend="${activeMenu == 'admin' ? 'active' : ''}"
                           href="#" id="adminDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            システム管理
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="adminDropdown">
                            <li><a class="dropdown-item" th:href="@{/admin/users}">ユーザー管理</a></li>
                            <li><a class="dropdown-item" th:href="@{/admin/roles}">ロール管理</a></li>
                            <li><a class="dropdown-item" th:href="@{/admin/masters}">マスタデータ管理</a></li>
                            <li><a class="dropdown-item" th:href="@{/admin/logs}">ログ管理</a></li>
                            <li><a class="dropdown-item" th:href="@{/admin/batch}">バッチ管理</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</body>
</html>